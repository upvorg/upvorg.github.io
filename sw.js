(()=>{"use strict";var a=(e,t,c)=>new Promise((h,r)=>{var i=n=>{try{s(c.next(n))}catch(l){r(l)}},o=n=>{try{s(c.throw(n))}catch(l){r(l)}},s=n=>n.done?h(n.value):Promise.resolve(n.value).then(i,o);s((c=c.apply(e,t)).next())});const u="asset-cache",f=e=>new Promise(t=>{setTimeout(()=>t(),e)}),m=/.+\.[0-9a-f]{8}\..*(js|css|woff2?|svg|png|jpg|jpeg|json|wasm)$/,p=/(.*cdnjs.cloudflare.com.*)|(.*fonts.googleapis.com.*)|(.*cdn-us.imgs.moe.*)/,d=["https://lib.baomitu.com/fonts/nanum-pen-script/nanum-pen-script-regular.woff2"];self.addEventListener("install",e=>{e.waitUntil(caches.open(u).then(function(t){return t.addAll(d)}).then(function(){return self.skipWaiting()}))}),self.addEventListener("activate",e=>{e.waitUntil(Promise.race([f(3e3),Promise.all([self.caches.delete(u),self.clients.claim()])]))}),self.addEventListener("fetch",e=>{const{url:t}=e.request;return!(!t.startsWith("http")||!(d.includes(t)||t.match(m)||t.match(p))||(e.respondWith(function(c){return a(this,null,function*(){const h=yield function(s,n){return a(this,null,function*(){try{return yield Promise.race([f(3e3).then(()=>Promise.reject(new Error("TIMEOUT"))),s()])}catch(l){return void console.error(l)}})}(()=>a(this,null,function*(){const s=yield self.caches.open(u),n=yield s.match(c.request);return{cache:s,cached:n}})),{cache:r,cached:i}=h||{};if(r&&i){if(i.ok)return i;yield r.delete(c.request)}const o=yield fetch(c.request);return o.ok&&r&&r.put(c.request,o.clone()),o})}(e)),0))})})();
